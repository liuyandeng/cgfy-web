<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Tagsinput Checkbox</title>
    <!--https://www.jb51.net/article/170548.htm-->
    <!--http://www.jq22.com-->
    <link rel="stylesheet" type="text/css" href="../plugins/jquery_tagsinput/css/jquery.tagsinput.css" >
    <script type="text/javascript" src="../js/jquery-3.2.1.js"></script>
    <script src="../plugins/jquery_tagsinput/js/jquery.tagsinput.min.js" ></script>
</head>


<body>
<!--业务需求：可以根据checkbox的先后勾选传递有顺序的值让后台接收，决定用tagsinput显示checkbox的先后勾选顺序，并实时响应checkbox的勾选状态-->
<!--思路：checkbox的值存在一个数组A，新创建一个数组B，如果选中一个，B push一个值，取消一个，remove一个值，因为数组是有序的，就做到响应checkbox的勾选顺序-->
<h3>记录checkbox勾选的顺序</h3>
checkbox:
<!--注意:id要保持唯一性-->
<input type="checkbox" id="Apple" name="fruit" value="苹果" onclick="checkedHandle(this)" >苹果</input>
<input type="checkbox" id="Pear" name="fruit" value="梨" onclick="checkedHandle(this)" >梨</input>
<input type="checkbox" id="Banana" name="fruit" value="香蕉" onclick="checkedHandle(this)" >香蕉</input>
<input type="checkbox" id="Orange" name="fruit" value="橘子" onclick="checkedHandle(this)" >橘子</input>
<br><br>
<input type="text" id="fruit-tags" name="fruit-tags" >
<input type="text" id="fruitChecked">
<script type="text/javascript">
    var fruitValue = new Array();
    var fruitName = [];
    var fruits = document.getElementsByName("fruit");
    fruits.forEach(function (e){
        fruitName.push(e.value);
    })
    $('#fruit-tags').tagsInput({
        interactive: false,
        removeWithBackspace: false,
        onRemoveTag:  function(tag){
            //重点 通过值获得数组的索引
            //删除  checkbox不勾选 数组remove值 显示改变
            var index = fruitName.indexOf(tag);
            var box=$("input:checkbox[name=fruit]").eq(index);
            box.prop("checked",false);
            fruitValue.removeBy(box.attr("id"));
            $('#fruitChecked').val(fruitValue.toString());
        }
    });

    function checkedHandle(obj){
        var idVal=$(obj).attr("id");
        // --- 选中 push--
        if($(obj).is(':checked')){//选中
            if($('#fruitChecked').val().indexOf(idVal) == -1){//没有匹配
                $('#fruit-tags').addTag($(obj).val());
                fruitValue.push(idVal);
            }
        }else{//取消选中
            var indexof=$('#fruitChecked').val().indexOf(idVal);
            if(indexof> -1){
                $('#fruit-tags').removeTag($(obj).val());
                fruitValue.removeBy(idVal);//通过id移除
            }
        }
        $('#fruitChecked').val(fruitValue.toString());
    }

    /**
     * array.splice(index,howmany,item1,.....,itemX)
     * index 	必需。规定从何处添加/删除元素。 该参数是开始插入和（或）删除的数组元素的下标，必须是数字。
     * howmany	可选。规定应该删除多少元素。必须是数字，但可以是 "0"。如果未规定此参数，则删除从 index 开始到原数组结尾的所有元素。
     * item1, ..., itemX	可选。要添加到数组的新元素
     */
    Array.prototype.removeBy = function(val) {
        for(var i=0; i<this.length; i++) {
            if(this[i] == val) {
                this.splice(i, 1);
                break;
            }
        }
    };



</script>

<h3>checkbox练习</h3>
<div><input type="checkbox" name="checkbox" value="111" onchange="change()" /><span>张三</span></div>
<div><input type="checkbox" name="checkbox" value="222" onchange="change()" /><span>李四</span></div>
<div><input type="checkbox" name="checkbox" value="333" onchange="change()" /><span>王五</span></div>
<h3 id="selected"></h3>
<script>
    //https://www.csdn.net/tags/MtTaEg0sMjU2MjctYmxvZwO0O0OO0O0O.html
    function change(){
        var obj=document.getElementsByName("checkbox")
        var value = new Array();
        for(var i = 0; i < obj.length; i++){
            if(obj[i].checked)
                value.push(obj[i].value);
        }
        $("#selected").html(value.toString())

    }

</script>
</body>
</html>